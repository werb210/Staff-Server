- name: Install dependencies
  run: npm ci

- name: Build TypeScript
  run: npm run build

- name: Prepare deploy folder
  run: |
    rm -rf deploy
    mkdir deploy
    cp -r dist deploy/
    cp package.json package-lock.json deploy/

- name: Zip deploy folder
  run: |
    cd deploy
    zip -r ../deploy.zip .

- name: Deploy to Azure App Service
  uses: azure/webapps-deploy@v3
  with:
    app-name: boreal-staff-server
    publish-profile: ${{ secrets.AZURE_WEBAPP_PUBLISH_PROFILE }}
    package: deploy.zip
